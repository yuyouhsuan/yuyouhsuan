<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SDGs 海灘清潔任務</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-image: url('https://upload.wikimedia.org/wikipedia/commons/thumb/5/52/Beach_background.jpg/1280px-Beach_background.jpg');
      background-size: cover;
      background-position: center;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    h1 {
      margin-top: 20px;
      background-color: rgba(255, 255, 255, 0.7);
      display: inline-block;
      padding: 10px;
    }
    #game-container {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      margin: 30px;
      min-height: 240px;
      background-color: rgba(255, 255, 255, 0.85);
      padding: 20px;
      border-radius: 10px;
    }
    .item, .bin, .clickable-trash, .choice-card {
      width: 100px;
      height: 100px;
      margin: 10px;
      padding: 10px;
      border: 2px dashed #ccc;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      cursor: pointer;
      background-color: #fff;
      border-radius: 12px;
    }
    .choice-card {
      border: 2px solid #03a9f4;
      background-color: #e1f5fe;
      color: #0277bd;
      border-radius: 20px;
      padding: 10px;
      margin: 5px auto;
      width: 80%;
    }
    .bin {
      border: 2px solid #00796b;
      background-color: #b2dfdb;
    }
    #result {
      margin-top: 20px;
      font-size: 1.2em;
      font-weight: bold;
      background-color: rgba(255, 255, 255, 0.8);
      display: inline-block;
      padding: 10px;
    }
    #next-btn {
      margin-top: 20px;
      padding: 10px 20px;
      font-size: 1em;
      display: none;
      background-color: #00bcd4;
      color: white;
      border: none;
      border-radius: 25px;
      cursor: pointer;
    }
    #next-btn:hover {
      background-color: #008ba3;
    }
    .float-box {
      background-color: rgba(255, 255, 255, 0.95);
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.2);
      position: relative;
      max-width: 300px;
      margin: 20px auto;
    }
    .mole-target {
      width: 80px;
      height: 80px;
      background-image: url('https://upload.wikimedia.org/wikipedia/commons/f/f4/PET_bottle_icon_color.svg');
      background-size: contain;
      background-repeat: no-repeat;
      position: absolute;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>SDGs 海灘清潔任務</h1>
  <p id="instructions">將物品拖曳到正確的垃圾桶！</p>
  <div id="game-container"></div>
  <div id="result"></div>
  <button id="next-btn">下一關</button>

  <script>
    const bottleImage = "https://upload.wikimedia.org/wikipedia/commons/f/f4/PET_bottle_icon_color.svg";

    const levels = [
      {
        type: "drag",
        items: { item1: "資源回收", item2: "廚餘", item3: "資源回收", item4: "有害垃圾" },
        labels: { item1: "寶特瓶", item2: "剩飯", item3: "報紙", item4: "舊手機" }
      },
      {
        type: "click-choice",
        image: bottleImage,
        question: "海灘上發現一個寶特瓶，你應該怎麼做？",
        options: ["把它丟回海裡", "忽略它", "丟入資源回收桶", "埋進沙子裡"],
        answer: "丟入資源回收桶"
      },
      {
        type: "mole",
        count: 5
      },
      {
        type: "memory",
        cards: [
          { id: 1, label: "寶特瓶", match: "資源回收" },
          { id: 2, label: "電池", match: "有害垃圾" },
          { id: 3, label: "果皮", match: "廚餘" },
          { id: 4, label: "破拖鞋", match: "一般垃圾" }
        ]
      },
      {
        type: "drag",
        items: { item1: "一般垃圾", item2: "資源回收", item3: "廚餘", item4: "有害垃圾" },
        labels: { item1: "保麗龍", item2: "鐵罐", item3: "果皮", item4: "過期藥品" }
      }
    ];

    let currentLevel = 0;
    let correctCount = 0;
    const bins = ["資源回收", "廚餘", "一般垃圾", "有害垃圾"];
    const container = document.getElementById("game-container");
    const result = document.getElementById("result");
    const nextBtn = document.getElementById("next-btn");
    const instructions = document.getElementById("instructions");

    function loadLevel(levelIndex) {
      container.innerHTML = "";
      result.innerText = "";
      nextBtn.style.display = "none";
      correctCount = 0;

      const level = levels[levelIndex];

      if (level.type === "click-choice") {
        instructions.innerText = "點擊寶特瓶並選擇正確答案！";
        const bottle = document.createElement("img");
        bottle.src = level.image;
        bottle.style.width = "100px";
        bottle.style.cursor = "pointer";
        bottle.onclick = () => {
          const box = document.createElement("div");
          box.className = "float-box";
          box.innerHTML = `<p>${level.question}</p>`;
          level.options.forEach(opt => {
            const btn = document.createElement("button");
            btn.className = "choice-card";
            btn.innerText = opt;
            btn.onclick = () => {
              if (opt === level.answer) {
                result.innerText = "答對了！做得好！";
                nextBtn.style.display = "inline-block";
              } else {
                result.innerText = "答錯了，請再試一次。";
              }
              box.remove();
            };
            box.appendChild(btn);
          });
          container.appendChild(box);
        };
        container.appendChild(bottle);
        return;
      }

      if (level.type === "mole") {
        instructions.innerText = "點擊海灘上出現的寶特瓶來清潔海灘！";
        let clicked = 0;
        for (let i = 0; i < level.count; i++) {
          const mole = document.createElement("div");
          mole.className = "mole-target";
          mole.style.top = Math.random() * 200 + "px";
          mole.style.left = Math.random() * 600 + "px";
          mole.style.position = "absolute";
          mole.onclick = () => {
            mole.remove();
            clicked++;
            if (clicked === level.count) {
              result.innerText = "全部寶特瓶清理完畢！";
              nextBtn.style.display = "inline-block";
            }
          };
          container.appendChild(mole);
        }
        return;
      }

      if (level.type === "memory") {
        instructions.innerText = "點擊兩張卡片找出正確分類配對！(尚未實作)";
        result.innerText = "(本關尚待開發)";
        nextBtn.style.display = "inline-block";
        return;
      }

      instructions.innerText = "將物品拖曳到正確的垃圾桶！";
      for (const [id, type] of Object.entries(level.items)) {
        const div = document.createElement("div");
        div.className = "item";
        div.id = id;
        div.innerText = level.labels[id];
        div.draggable = true;
        div.addEventListener("dragstart", e => {
          e.dataTransfer.setData("text/plain", id);
        });
        container.appendChild(div);
      }
      bins.forEach(binType => {
        const bin = document.createElement("div");
        bin.className = "bin";
        bin.dataset.type = binType;
        bin.innerText = binType;
        bin.addEventListener("dragover", e => e.preventDefault());
        bin.addEventListener("drop", e => {
          const itemId = e.dataTransfer.getData("text/plain");
          const item = document.getElementById(itemId);
          if (!item) return;
          const correctType = level.items[itemId];
          if (correctType === binType) {
            bin.appendChild(item);
            item.setAttribute("draggable", false);
            item.style.cursor = "default";
            correctCount++;
            if (correctCount === Object.keys(level.items).length) {
              if (currentLevel < levels.length - 1) {
                result.innerText = "太棒了！準備進入下一關...";
                nextBtn.style.display = "inline-block";
              } else {
                result.innerText = "🎉 恭喜你完成全部 5 關！你是分類達人！";
              }
            }
          } else {
            alert("分類錯誤，再試試看！");
          }
        });
        container.appendChild(bin);
      });
    }

    nextBtn.addEventListener("click", () => {
      currentLevel++;
      loadLevel(currentLevel);
    });

    loadLevel(currentLevel);
  </script>
</body>
</html>